// reportFormatter.test.js
const {
  formatDailyReport,
} = require("../../src/daily-report/reportFormatter");

describe("reportFormatter", () => {
  const repoInfo = { owner: "testowner", repo: "testrepo" };

  test("ë¶„ì„ ê²°ê³¼ê°€ ì—†ìœ¼ë©´ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤", () => {
    const result = formatDailyReport(null, repoInfo);

    expect(result).toBe("ì¼ì¼ ë³´ê³ ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  });

  test("ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ ë³´ê³ ì„œë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤", () => {
    const analysisResult = {
      summary: "ğŸ“ ì˜¤ëŠ˜ì€ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.",
    };

    const result = formatDailyReport(analysisResult, repoInfo);

    // í—¤ë” í™•ì¸
    expect(result).toContain("ğŸ“Š *ì¼ì¼ ê°œë°œ ë³´ê³ ì„œ*");
    expect(result).toContain("testowner/testrepo");

    // ë³¸ë¬¸ í™•ì¸
    expect(result).toContain("ğŸ“ ì˜¤ëŠ˜ì€ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.");

    // í‘¸í„° í™•ì¸
    expect(result).toContain("ğŸ¤– Generated by Gemini AI");
  });

  test("ë‚ ì§œê°€ í•œêµ­ì–´ í˜•ì‹ìœ¼ë¡œ í¬í•¨ë˜ì–´ì•¼ í•œë‹¤", () => {
    const analysisResult = { summary: "í…ŒìŠ¤íŠ¸" };

    const result = formatDailyReport(analysisResult, repoInfo);

    // í•œêµ­ì–´ ë‚ ì§œ í˜•ì‹ í™•ì¸ (ì˜ˆ: 2024ë…„ 1ì›” 28ì¼ ì¼ìš”ì¼)
    expect(result).toMatch(/\d{4}ë…„ \d{1,2}ì›” \d{1,2}ì¼/);
  });
});
